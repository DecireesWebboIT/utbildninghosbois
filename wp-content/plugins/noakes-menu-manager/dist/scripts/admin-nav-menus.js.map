{"version":3,"sources":["admin-nav-menus.js"],"names":["wpNavMenu","nmm_dragged_item","nmm_dropped_item","nmm_hovered_item","$","nmm","data","events","admin","nav_menus","extend","timeout","callbacks","stored","add","callback","length","fire","shift","check_collapsibility","has_collapsible","each","menu_item","this","hasClass","nmm_direct_child_menu_items","removeClass","addClass","all_buttons","stop","is_visible","is","slideDown","css","slideUp","clear_hovered","clearTimeout","collapse_expand","first","parent","attr","insertBefore","closest","find","click","not","nmm_trigger_all","button","on","current","is_null","setTimeout","triggerHandler","appendTo","complete","children","filter","childMenuItems","mousemove","dragged_position","position","right","left","width","bottom","top","height","collapsed","menuList","override_nav_menus","fn","default_shiftDepthClass","shiftDepthClass","change","menuItemDepth","hide","e","ui","item","window","unbind","default_addItemToMenu","addItemToMenu","default_eventOnClickMenuItemDelete","eventOnClickMenuItemDelete","default_registerChange","registerChange","process_method","help_buttons","clicked","current_depth","prevAll","result","depth","next","target_depth","include","scroll_stop","document","ready","body","jQuery"],"mappings":"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","file":"admin-nav-menus.js","sourcesContent":["/*!\r\n * Admin nav menus JavaScript include.\r\n * \r\n * @since 1.3.0\r\n * \r\n * @package Nav Menu Manager\r\n */\r\n\r\n/**\r\n * Main WordPress nav menus object.\r\n * \r\n * @since 1.2.4\r\n * \r\n * @var    object\r\n */\r\nvar wpNavMenu = wpNavMenu || {};\r\n\r\n/**\r\n * Nav menu item currently being dragged.\r\n * \r\n * @since 1.2.0\r\n * \r\n * @var    object\r\n */\r\nvar nmm_dragged_item = null;\r\n\r\n/**\r\n * Last nav menu item dropped.\r\n * \r\n * @since 1.2.0\r\n * \r\n * @var    object\r\n */\r\nvar nmm_dropped_item = null;\r\n\r\n/**\r\n * Item currently hovered over.\r\n * \r\n * @since 1.2.0\r\n * \r\n * @var    object\r\n */\r\nvar nmm_hovered_item = null;\r\n\r\n(function ($)\r\n{\r\n\t'use strict';\r\n\r\n\t/**\r\n\t * Primary JSON objects.\r\n\t * \r\n\t * @since 1.2.0\r\n\t * \r\n\t * @access jQuery.nmm, jQuery.nmm.data, jQuery.nmm.events, jQuery.nmm.admin, jQuery.nmm.admin.nav_menus\r\n\t * @var    object\r\n\t */\r\n\t$.nmm = $.nmm || {};\r\n\t$.nmm.data = $.nmm.data || {};\r\n\t$.nmm.events = $.nmm.events || {};\r\n\t$.nmm.admin = $.nmm.admin || {};\r\n\t$.nmm.admin.nav_menus = $.nmm.admin.nav_menus || {};\r\n\r\n\t/**\r\n\t * Custom data variable names.\r\n\t * \r\n\t * @since 1.2.0\r\n\t * \r\n\t * @access jQuery.nmm.data\r\n\t * @var    object\r\n\t */\r\n\t$.extend($.nmm.data,\r\n\t{\r\n\t\t'timeout': 'nmm-timeout'\r\n\t});\r\n\r\n\t/**\r\n\t * Custom event names.\r\n\t * \r\n\t * @since 1.2.0\r\n\t * \r\n\t * @access jQuery.nmm.events\r\n\t * @var    object\r\n\t */\r\n\t$.extend($.nmm.events,\r\n\t{\r\n\t\t'extend': 'nmm-extend'\r\n\t});\r\n\r\n\t/**\r\n\t * Plugin nav menus functionality.\r\n\t * \r\n\t * @since 1.2.0\r\n\t * \r\n\t * @access jQuery.nmm.admin.nav_menus\r\n\t * @var    object\r\n\t */\r\n\t$.extend($.nmm.admin.nav_menus,\r\n\t{\r\n\t\t/**\r\n\t\t * Callbacks stored for the add item to menu functionality.\r\n\t\t * \r\n\t\t * @since 1.2.0\r\n\t\t * \r\n\t\t * @access jQuery.nmm.admin.nav_menus.callbacks\r\n\t\t * @var    object\r\n\t\t */\r\n\t\t'callbacks':\r\n\t\t{\r\n\t\t\t/**\r\n\t\t\t * Array of stored nav menu callbacks.\r\n\t\t\t * \r\n\t\t\t * @since 1.2.0\r\n\t\t\t * \r\n\t\t\t * @access jQuery.nmm.admin.nav_menus.callbacks.stored\r\n\t\t\t * @var    array\r\n\t\t\t */\r\n\t\t\t'stored': [],\r\n\r\n\t\t\t/**\r\n\t\t\t * Store a nav menu callback.\r\n\t\t\t * \r\n\t\t\t * @since 1.2.0\r\n\t\t\t * \r\n\t\t\t * @access jQuery.nmm.admin.nav_menus.callbacks.add\r\n\t\t\t * @param  function callback Callback to store.\r\n\t\t\t * @return void\r\n\t\t\t */\r\n\t\t\t'add': function (callback)\r\n\t\t\t{\r\n\t\t\t\tif (typeof callback === 'function')\r\n\t\t\t\t{\r\n\t\t\t\t\t$.nmm.admin.nav_menus.callbacks.stored[$.nmm.admin.nav_menus.callbacks.stored.length] = callback;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * Fire the first stored nav menu callback.\r\n\t\t\t * \r\n\t\t\t * @since 1.2.0\r\n\t\t\t * \r\n\t\t\t * @access jQuery.nmm.admin.nav_menus.callbacks.fire\r\n\t\t\t * @return void\r\n\t\t\t */\r\n\t\t\t'fire': function ()\r\n\t\t\t{\r\n\t\t\t\tif ($.nmm.admin.nav_menus.callbacks.stored.length > 0)\r\n\t\t\t\t{\r\n\t\t\t\t\t$.nmm.admin.nav_menus.callbacks.stored.shift()();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Check nav menu items for collapsibility.\r\n\t\t * \r\n\t\t * @since 1.2.0\r\n\t\t * \r\n\t\t * @access jQuery.nmm.admin.nav_menus.check_collapsibility\r\n\t\t * @return void\r\n\t\t */\r\n\t\t'check_collapsibility': function ()\r\n\t\t{\r\n\t\t\tvar has_collapsible = false;\r\n\r\n\t\t\t$('#menu-to-edit > .menu-item')\r\n\t\t\t.each(function ()\r\n\t\t\t{\r\n\t\t\t\tvar menu_item = $(this);\r\n\r\n\t\t\t\tif (menu_item.hasClass('deleting') || menu_item.nmm_direct_child_menu_items().length === 0)\r\n\t\t\t\t{\r\n\t\t\t\t\tmenu_item.removeClass('nmm-collapsible nmm-collapsed');\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\thas_collapsible = true;\r\n\r\n\t\t\t\t\tmenu_item.addClass('nmm-collapsible');\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tvar all_buttons = $('#nmm-collapse-expand-all').stop(true);\r\n\t\t\tvar is_visible = all_buttons.is(':visible');\r\n\r\n\t\t\tif (has_collapsible && !is_visible)\r\n\t\t\t{\r\n\t\t\t\tall_buttons\r\n\t\t\t\t.slideDown(200, function ()\r\n\t\t\t\t{\r\n\t\t\t\t\t$(this).css('height', '');\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse if (!has_collapsible && is_visible)\r\n\t\t\t{\r\n\t\t\t\tall_buttons\r\n\t\t\t\t.slideUp(200, function ()\r\n\t\t\t\t{\r\n\t\t\t\t\t$(this).css('height', '');\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Clear the timeout when hovering out of a nav menu item.\r\n\t\t * \r\n\t\t * @since 1.2.0\r\n\t\t * \r\n\t\t * @access jQuery.nmm.admin.nav_menus.clear_hovered\r\n\t\t * @return void\r\n\t\t */\r\n\t\t'clear_hovered': function ()\r\n\t\t{\r\n\t\t\tif (nmm_hovered_item !== null)\r\n\t\t\t{\r\n\t\t\t\tclearTimeout(nmm_hovered_item.data($.nmm.data.timeout));\r\n\r\n\t\t\t\tnmm_hovered_item = null;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Prepare collapse/expand functionality.\r\n\t\t * \r\n\t\t * @since 1.2.0\r\n\t\t * \r\n\t\t * @access jQuery.nmm.admin.nav_menus.collapse_expand\r\n\t\t * @return void\r\n\t\t */\r\n\t\t'collapse_expand': function ()\r\n\t\t{\r\n\t\t\tvar all_buttons = $('.nmm-collapse-expand-all').first();\r\n\r\n\t\t\tif (!all_buttons.parent().is('#post-body-content'))\r\n\t\t\t{\r\n\t\t\t\tall_buttons.attr('id', 'nmm-collapse-expand-all').insertBefore(all_buttons.closest('ul'));\r\n\r\n\t\t\t\tall_buttons.find('.nmm-collapse-all')\r\n\t\t\t\t.click(function ()\r\n\t\t\t\t{\r\n\t\t\t\t\t$('.nmm-collapsible').not('.nmm-collapsed').find('.nmm-collapse-expand').nmm_trigger_all('click');\r\n\t\t\t\t});\r\n\r\n\t\t\t\tall_buttons.find('.nmm-expand-all')\r\n\t\t\t\t.click(function ()\r\n\t\t\t\t{\r\n\t\t\t\t\t$('.nmm-collapsed').find('.nmm-collapse-expand').nmm_trigger_all('click');\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t$('.menu-item > .menu-item-settings > .nmm-buttons > .nmm-collapse-expand')\r\n\t\t\t.each(function ()\r\n\t\t\t{\r\n\t\t\t\tvar button = $(this);\r\n\r\n\t\t\t\tvar menu_item = button.closest('.menu-item')\r\n\t\t\t\t.on($.nmm.events.extend, function ()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar current = $(this);\r\n\t\t\t\t\tvar is_null = (nmm_hovered_item === null);\r\n\r\n\t\t\t\t\tif (is_null || !nmm_hovered_item.is(current))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (!is_null)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$.nmm.admin.nav_menus.clear_hovered();\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tnmm_hovered_item = current;\r\n\r\n\t\t\t\t\t\tnmm_hovered_item\r\n\t\t\t\t\t\t.data($.nmm.data.timeout, setTimeout(function ()\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tnmm_hovered_item.find('.nmm-collapse-expand').triggerHandler('click');\r\n\t\t\t\t\t\t\t$.nmm.admin.nav_menus.clear_hovered();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t1000));\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tbutton.appendTo(menu_item.find('.item-controls'));\r\n\t\t\t})\r\n\t\t\t.click(function ()\r\n\t\t\t{\r\n\t\t\t\tvar menu_item = $(this).closest('.menu-item');\r\n\r\n\t\t\t\tvar complete = function ()\r\n\t\t\t\t{\r\n\t\t\t\t\t$(this).css('height', '');\r\n\t\t\t\t};\r\n\r\n\t\t\t\tif (menu_item.hasClass('nmm-collapsed'))\r\n\t\t\t\t{\r\n\t\t\t\t\tmenu_item.removeClass('nmm-collapsed');\r\n\r\n\t\t\t\t\tvar children = menu_item.nmm_direct_child_menu_items();\r\n\r\n\t\t\t\t\twhile (children.length > 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tchildren.stop(true).slideDown(200, complete);\r\n\t\t\t\t\t\tchildren = children.filter('.nmm-collapsible').not('.nmm-collapsed').nmm_direct_child_menu_items();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tmenu_item.addClass('nmm-collapsed');\r\n\t\t\t\t\tmenu_item.childMenuItems().stop(true).slideUp(200, complete);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$.nmm.admin.nav_menus.check_collapsibility();\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Check the position of the dragged item.\r\n\t\t * \r\n\t\t * @since 1.2.0\r\n\t\t * \r\n\t\t * @access jQuery.nmm.admin.nav_menus.mousemove\r\n\t\t * @return void\r\n\t\t */\r\n\t\t'mousemove': function ()\r\n\t\t{\r\n\t\t\tvar dragged_position = nmm_dragged_item.position();\r\n\t\t\tdragged_position.right = dragged_position.left + nmm_dragged_item.width();\r\n\t\t\tdragged_position.bottom = dragged_position.top + nmm_dragged_item.height();\r\n\r\n\t\t\tvar collapsed = wpNavMenu.menuList.children('.menu-item.nmm-collapsed:visible').not(nmm_dragged_item)\r\n\t\t\t.filter(function ()\r\n\t\t\t{\r\n\t\t\t\tvar current = $(this);\r\n\t\t\t\tvar position = current.position();\r\n\r\n\t\t\t\treturn (position.top <= dragged_position.bottom && position.top + current.height() >= dragged_position.top && position.left <= dragged_position.right && position.left + current.width() >= dragged_position.left);\r\n\t\t\t})\r\n\t\t\t.first();\r\n\r\n\t\t\tif (collapsed.length === 0)\r\n\t\t\t{\r\n\t\t\t\t$.nmm.admin.nav_menus.clear_hovered();\r\n\t\t\t}\r\n\t\t\telse if (!collapsed.is(nmm_hovered_item))\r\n\t\t\t{\r\n\t\t\t\tcollapsed.triggerHandler($.nmm.events.extend);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Tap into the built-in WordPress nav menus functionality.\r\n\t\t * \r\n\t\t * @since 1.2.4 Expand collapsed items when parent item is removed.\r\n\t\t * @since 1.2.0\r\n\t\t * \r\n\t\t * @access jQuery.nmm.admin.nav_menus.override_nav_menus\r\n\t\t * @return void\r\n\t\t */\r\n\t\t'override_nav_menus': function ()\r\n\t\t{\r\n\t\t\t$.fn.default_shiftDepthClass = $.fn.shiftDepthClass;\r\n\r\n\t\t\t$.fn.shiftDepthClass = function (change)\r\n\t\t\t{\r\n\t\t\t\tthis.default_shiftDepthClass(change);\r\n\r\n\t\t\t\treturn this\r\n\t\t\t\t.each(function ()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar current = $(this);\r\n\r\n\t\t\t\t\tif (current.menuItemDepth() === 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcurrent.find('.is-submenu').hide();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\twpNavMenu.menuList\r\n\t\t\t.on('sortstart', function (e, ui)\r\n\t\t\t{\r\n\t\t\t\tnmm_dragged_item = ui.item;\r\n\r\n\t\t\t\t$(window).mousemove($.nmm.admin.nav_menus.mousemove);\r\n\t\t\t})\r\n\t\t\t.on('sortstop', function (e, ui)\r\n\t\t\t{\r\n\t\t\t\t$(window).unbind('mousemove', $.nmm.admin.nav_menus.mousemove);\r\n\r\n\t\t\t\t$.nmm.admin.nav_menus.clear_hovered();\r\n\r\n\t\t\t\tnmm_dragged_item = null;\r\n\t\t\t\tnmm_dropped_item = ui.item;\r\n\t\t\t});\r\n\r\n\t\t\twpNavMenu.default_addItemToMenu = wpNavMenu.addItemToMenu;\r\n\t\t\twpNavMenu.default_eventOnClickMenuItemDelete = wpNavMenu.eventOnClickMenuItemDelete;\r\n\t\t\twpNavMenu.default_registerChange = wpNavMenu.registerChange;\r\n\r\n\t\t\twpNavMenu.addItemToMenu = function (menu_item, process_method, callback)\r\n\t\t\t{\r\n\t\t\t\t$('.menu-item.pending:hidden').addClass('hidden');\r\n\r\n\t\t\t\t$.nmm.admin.nav_menus.callbacks.add(callback);\r\n\r\n\t\t\t\tcallback = function ()\r\n\t\t\t\t{\r\n\t\t\t\t\t$('.menu-item.hidden').stop(true, true).hide().removeClass('hidden');\r\n\r\n\t\t\t\t\t$.nmm.admin.nav_menus.callbacks.fire();\r\n\t\t\t\t\t$.nmm.admin.help_buttons();\r\n\t\t\t\t\t$.nmm.admin.nav_menus.collapse_expand();\r\n\t\t\t\t};\r\n\r\n\t\t\t\twpNavMenu.default_addItemToMenu(menu_item, process_method, callback);\r\n\t\t\t};\r\n\r\n\t\t\twpNavMenu.eventOnClickMenuItemDelete = function (clicked)\r\n\t\t\t{\r\n\t\t\t\tvar menu_item = $(clicked).closest('.menu-item');\r\n\r\n\t\t\t\tif (menu_item.is('.nmm-collapsed'))\r\n\t\t\t\t{\r\n\t\t\t\t\tmenu_item.find('.nmm-collapse-expand').nmm_trigger_all('click');\r\n\t\t\t\t}\r\n\r\n\t\t\t\twpNavMenu.default_eventOnClickMenuItemDelete(clicked);\r\n\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\r\n\t\t\twpNavMenu.registerChange = function ()\r\n\t\t\t{\r\n\t\t\t\twpNavMenu.default_registerChange();\r\n\t\t\t\t$.nmm.admin.nav_menus.check_collapsibility();\r\n\r\n\t\t\t\tif (nmm_dropped_item !== null)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar current_depth = nmm_dropped_item.menuItemDepth();\r\n\r\n\t\t\t\t\twhile (current_depth > 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcurrent_depth -= 1;\r\n\r\n\t\t\t\t\t\tvar parent = nmm_dropped_item.prevAll('.menu-item-depth-' + current_depth).first();\r\n\r\n\t\t\t\t\t\tif (parent.hasClass('nmm-collapsed'))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tparent.find('.nmm-collapse-expand').triggerHandler('click');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tnmm_dropped_item = null;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\t});\r\n\r\n\t$.fn.extend(\r\n\t{\r\n\t\t/**\r\n\t\t * Return the direct children for the provided nav menu item.\r\n\t\t * \r\n\t\t * @since 1.2.4 Added functionality for deleted parent items.\r\n\t\t * @since 1.2.0\r\n\t\t * \r\n\t\t * @access jQuery.fn.nmm_direct_child_menu_items\r\n\t\t * @this   object Nav menu item to get children for.\r\n\t\t * @return object Direct nav menu item children.\r\n\t\t */\r\n\t\t'nmm_direct_child_menu_items': function ()\r\n\t\t{\r\n\t\t\tvar result = $();\r\n\r\n\t\t\tthis\r\n\t\t\t.each(function ()\r\n\t\t\t{\r\n\t\t\t\tvar menu_item = $(this);\r\n\t\t\t\tvar depth = menu_item.menuItemDepth();\r\n\t\t\t\tvar next = menu_item.next('.menu-item');\r\n\t\t\t\tvar target_depth = (next.length === 0) ? depth : next.menuItemDepth();\r\n\t\t\t\tvar current_depth = target_depth;\r\n\r\n\t\t\t\twhile (next.length > 0 && current_depth > depth)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (next.hasClass('deleting'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tresult = result.add(next.nmm_direct_child_menu_items());\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (current_depth === target_depth)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tresult = result.add(next);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tnext = next.next('.menu-item');\r\n\t\t\t\t\tcurrent_depth = (next.length === 0) ? depth : next.menuItemDepth();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\treturn result;\r\n\t\t}\r\n\t});\r\n\r\n\t$.nmm.include.scroll_stop();\r\n\r\n\t$(document)\r\n\t.ready(function ()\r\n\t{\r\n\t\tif ($(document.body).hasClass('nmm-collapse-expand-enabled'))\r\n\t\t{\r\n\t\t\t$.nmm.admin.nav_menus.override_nav_menus();\r\n\t\t\t$.nmm.admin.nav_menus.collapse_expand();\r\n\t\t}\r\n\t});\r\n})\r\n(jQuery);\r\n"]}